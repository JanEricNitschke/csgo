<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>awpy.analytics.stats &mdash; awpy 1.0 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> awpy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Example Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../projects.html">Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq.html">Frequently Asked Questions (FAQs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License and Acknowledgments</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../analytics.html">Analytics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../parser.html">Parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../visualization.html">Visualization</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">awpy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      <li>awpy.analytics.stats</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for awpy.analytics.stats</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>


<div class="viewcode-block" id="extract_num_filters"><a class="viewcode-back" href="../../../analytics.html#awpy.analytics.stats.extract_num_filters">[docs]</a><span class="k">def</span> <span class="nf">extract_num_filters</span><span class="p">(</span>
    <span class="n">filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]],</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Extracts the numeric column filters from a key-value pair in a dictionary.</span>

<span class="sd">    Extracts logical operators and numeric values from the column filters in the</span>
<span class="sd">    the value of a specified key in the dictionary represented by filters.</span>

<span class="sd">    Args:</span>
<span class="sd">        filters: A dictionary where the keys are the columns of the dataframe</span>
<span class="sd">            represented by df to filter the data by and the values are lists</span>
<span class="sd">            that contain the column filters.</span>
<span class="sd">        key: The key in the dictionary represented by filters for which the</span>
<span class="sd">            numeric column filters should be extracted.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple of two lists where the first list contains all of the logical</span>
<span class="sd">        operators in the column filters in the value of a specified key and the</span>
<span class="sd">        second list contains all of the numeric values in the column filters in</span>
<span class="sd">        the value of a specified key. For example:</span>
<span class="sd">        ([&quot;&gt;&quot;, &quot;&lt;&quot;], [15.0, 25.0])</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: The value of the specified key contains a column filter of</span>
<span class="sd">            type boolean.</span>
<span class="sd">        Exception: The column filters in the value of the specified key contain</span>
<span class="sd">            an invalid logical operator.</span>
<span class="sd">        Exception: The column filters in the value of the specified key contain</span>
<span class="sd">            an invalid numeric value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sign_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">val_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">filters</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;Filter(s) for column &quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&quot; must be of type &#39;</span> <span class="sa">f</span><span class="s2">&quot;string.&quot;</span>
            <span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">sign</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">():</span>
            <span class="n">sign</span> <span class="o">+=</span> <span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">end_index</span> <span class="o">=</span> <span class="n">i</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">sign</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;==&quot;</span><span class="p">,</span> <span class="s2">&quot;!=&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;=&quot;</span><span class="p">,</span> <span class="s2">&quot;&gt;=&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;Invalid logical operator in filters for &quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&quot;&#39;</span> <span class="sa">f</span><span class="s2">&quot; column.&quot;</span>
            <span class="p">)</span>
        <span class="n">sign_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sign</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">index</span><span class="p">[</span><span class="n">end_index</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]))</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">ve</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;Invalid numerical value in filters for &quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&quot; &#39;</span> <span class="sa">f</span><span class="s2">&quot;column.&quot;</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="nn">ve</span>
    <span class="k">return</span> <span class="n">sign_list</span><span class="p">,</span> <span class="n">val_list</span></div>


<div class="viewcode-block" id="check_filters"><a class="viewcode-back" href="../../../analytics.html#awpy.analytics.stats.check_filters">[docs]</a><span class="k">def</span> <span class="nf">check_filters</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]):</span>
    <span class="sd">&quot;&quot;&quot;Checks if the column filters are valid.</span>

<span class="sd">    Iterates through each key-value pair in the dictionary represented by</span>
<span class="sd">    filters and checks if the column filters for columns of type boolean are</span>
<span class="sd">    of type boolean and the column filters for columns of type string are of</span>
<span class="sd">    type string. Calls the function extract_numeric_filters to check if the</span>
<span class="sd">    column filters for columns of type float and integer are valid.</span>

<span class="sd">    Args:</span>
<span class="sd">        df: A dataframe to be filtered.</span>
<span class="sd">        filters: A dictionary where the keys are the columns of the dataframe</span>
<span class="sd">            represented by df to filter the data by and the values are lists</span>
<span class="sd">            that contain the column filters.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: The value of a key corresponding to a column of type boolean</span>
<span class="sd">            contains a column filter of a different type.</span>
<span class="sd">        ValueError: The value of a key corresponding to a column of type string</span>
<span class="sd">            contains a column filter of a different type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">filters</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;bool&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">filters</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;Filter(s) for column &quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&quot; must be &#39;</span> <span class="sa">f</span><span class="s2">&quot;of type boolean&quot;</span>
                    <span class="p">)</span>
        <span class="k">elif</span> <span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;O&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">filters</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;Filter(s) for column &quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&quot; must be &#39;</span> <span class="sa">f</span><span class="s2">&quot;of type string&quot;</span>
                    <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">extract_num_filters</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span></div>


<div class="viewcode-block" id="num_filter_df"><a class="viewcode-back" href="../../../analytics.html#awpy.analytics.stats.num_filter_df">[docs]</a><span class="k">def</span> <span class="nf">num_filter_df</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sign</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Filters numeric data in a dataframe.</span>

<span class="sd">    Args:</span>
<span class="sd">        df: A dataframe to be filtered.</span>
<span class="sd">        col: A column of the dataframe represented by df to filter by.</span>
<span class="sd">        sign: A logical operator representing the operation to filter the</span>
<span class="sd">            dataframe represented by df by.</span>
<span class="sd">        val: A numeric value to filter the dataframe represented by df by.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A filtered dataframe.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ops</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;==&quot;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">val</span><span class="p">),</span>
        <span class="s2">&quot;!=&quot;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">val</span><span class="p">),</span>
        <span class="s2">&quot;&lt;=&quot;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">val</span><span class="p">),</span>
        <span class="s2">&quot;&gt;=&quot;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">val</span><span class="p">),</span>
        <span class="s2">&quot;&lt;&quot;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">val</span><span class="p">),</span>
        <span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">val</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ops</span><span class="p">[</span><span class="n">sign</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">filtered_df</span></div>


<div class="viewcode-block" id="filter_df"><a class="viewcode-back" href="../../../analytics.html#awpy.analytics.stats.filter_df">[docs]</a><span class="k">def</span> <span class="nf">filter_df</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Filters data in a dataframe.</span>

<span class="sd">    Filters a dataframe for columns of type boolean and string and calls the</span>
<span class="sd">    function num_filter_df to filter a dataframe for columns of type float</span>
<span class="sd">    and integer.</span>

<span class="sd">    Args:</span>
<span class="sd">        df: A dataframe to be filtered.</span>
<span class="sd">        filters: A dictionary where the keys are the columns of the dataframe</span>
<span class="sd">            represented by df to filter the data by and the values are lists</span>
<span class="sd">            that contain the column filters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A filtered dataframe.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df_copy</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">check_filters</span><span class="p">(</span><span class="n">df_copy</span><span class="p">,</span> <span class="n">filters</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">filters</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">df_copy</span><span class="o">.</span><span class="n">dtypes</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;bool&quot;</span> <span class="ow">or</span> <span class="n">df_copy</span><span class="o">.</span><span class="n">dtypes</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;O&quot;</span><span class="p">:</span>
            <span class="n">df_copy</span> <span class="o">=</span> <span class="n">df_copy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_copy</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">filters</span><span class="p">[</span><span class="n">key</span><span class="p">])]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">extract_num_filters</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="n">key</span><span class="p">)[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">extract_num_filters</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="n">key</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                <span class="n">df_copy</span> <span class="o">=</span> <span class="n">num_filter_df</span><span class="p">(</span>
                    <span class="n">df_copy</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">extract_num_filters</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="n">key</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">val</span>
                <span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">df_copy</span></div>


<div class="viewcode-block" id="calc_stats"><a class="viewcode-back" href="../../../analytics.html#awpy.analytics.stats.calc_stats">[docs]</a><span class="k">def</span> <span class="nf">calc_stats</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]],</span>
    <span class="n">col_to_groupby</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">col_to_agg</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">agg</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">col_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Calculates statistics for a dataframe.</span>

<span class="sd">    Calls the function filter_df to filter a data in dataframe and then performs</span>
<span class="sd">    groupby and aggregation operations on the dataframe and renames the columns.</span>

<span class="sd">    Args:</span>
<span class="sd">        df: A dataframe from which statistics should be calculated.</span>
<span class="sd">        filters: A dictionary where the keys are the columns of the dataframe</span>
<span class="sd">            represented by df to filter the data by and the values are lists</span>
<span class="sd">            that contain the column filters.</span>
<span class="sd">        col_to_groupby: Columns of the dataframe represented by df to perform</span>
<span class="sd">            the groupby operation on.</span>
<span class="sd">        col_to_agg: Columns of the dataframe represented by df to perform</span>
<span class="sd">            aggregation operations on.</span>
<span class="sd">        agg: The aggregation operations to be applied to the columns in the list</span>
<span class="sd">            represented by col_to_agg.</span>
<span class="sd">        col_names: Column names for the returned dataframe.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dataframe with the specified statistics.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df_copy</span> <span class="o">=</span> <span class="n">filter_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">filters</span><span class="p">)</span>
    <span class="n">agg_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">col_to_agg</span><span class="p">,</span> <span class="n">agg</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">col_to_agg</span><span class="p">:</span>
        <span class="n">df_copy</span> <span class="o">=</span> <span class="n">df_copy</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">col_to_groupby</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">agg_dict</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">df_copy</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">col_names</span>
    <span class="k">return</span> <span class="n">df_copy</span></div>


<div class="viewcode-block" id="accuracy"><a class="viewcode-back" href="../../../analytics.html#awpy.analytics.stats.accuracy">[docs]</a><span class="k">def</span> <span class="nf">accuracy</span><span class="p">(</span>
    <span class="n">damage_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">weapon_fire_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">team</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">damage_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">weapon_fire_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns a dataframe with accuracy statistics.</span>

<span class="sd">    Args:</span>
<span class="sd">        damage_data: A dataframe with damage data.</span>
<span class="sd">        weapon_fire_data: A dataframe with weapon fire data.</span>
<span class="sd">        team: A boolean specifying wheter to calculate statistics for each team</span>
<span class="sd">            or for each player. The default is to calculate statistics for</span>
<span class="sd">            each player.</span>
<span class="sd">        damage_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by damage_data to filter the damage data by</span>
<span class="sd">            and the values are lists that contain the column filters.</span>
<span class="sd">        weapon_fire_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by weapon_fires to filter the weapon fire data</span>
<span class="sd">            by and the values are lists that contain the column filters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dataframe with the total shots, strafe shots, hits, accuracy (hits/total number of shots), headshot accuracy (head hits/total number of shots)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;playerName&quot;</span><span class="p">,</span> <span class="s2">&quot;attackerName&quot;</span><span class="p">,</span> <span class="s2">&quot;Player&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">team</span><span class="p">:</span>
        <span class="n">stats</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;playerTeam&quot;</span><span class="p">,</span> <span class="s2">&quot;attackerTeam&quot;</span><span class="p">,</span> <span class="s2">&quot;Team&quot;</span><span class="p">]</span>
    <span class="n">weapon_fires</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">weapon_fire_data</span><span class="p">,</span>
        <span class="n">weapon_fire_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;Weapon Fires&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">strafe_fires</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">weapon_fire_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">weapon_fire_data</span><span class="p">[</span><span class="s2">&quot;playerStrafe&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">],</span>
        <span class="n">weapon_fire_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;Strafe Fires&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">hits</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">damage_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">damage_data</span><span class="p">[</span><span class="s2">&quot;attackerTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">damage_data</span><span class="p">[</span><span class="s2">&quot;victimTeam&quot;</span><span class="p">]],</span>
        <span class="n">damage_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;Hits&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">headshots</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">damage_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="p">(</span><span class="n">damage_data</span><span class="p">[</span><span class="s2">&quot;attackerTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">damage_data</span><span class="p">[</span><span class="s2">&quot;victimTeam&quot;</span><span class="p">])</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">damage_data</span><span class="p">[</span><span class="s2">&quot;hitGroup&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Head&quot;</span><span class="p">)</span>
        <span class="p">],</span>
        <span class="n">damage_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;Headshots&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="n">weapon_fires</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">strafe_fires</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="n">acc</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">hits</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="n">acc</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">headshots</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">acc</span><span class="p">[</span><span class="s2">&quot;Strafe%&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">acc</span><span class="p">[</span><span class="s2">&quot;Strafe Fires&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">acc</span><span class="p">[</span><span class="s2">&quot;Weapon Fires&quot;</span><span class="p">]</span>
    <span class="n">acc</span><span class="p">[</span><span class="s2">&quot;ACC%&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">acc</span><span class="p">[</span><span class="s2">&quot;Hits&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">acc</span><span class="p">[</span><span class="s2">&quot;Weapon Fires&quot;</span><span class="p">]</span>
    <span class="n">acc</span><span class="p">[</span><span class="s2">&quot;HS ACC%&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">acc</span><span class="p">[</span><span class="s2">&quot;Headshots&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">acc</span><span class="p">[</span><span class="s2">&quot;Weapon Fires&quot;</span><span class="p">]</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="n">acc</span><span class="p">[[</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;Weapon Fires&quot;</span><span class="p">,</span> <span class="s2">&quot;Strafe%&quot;</span><span class="p">,</span> <span class="s2">&quot;ACC%&quot;</span><span class="p">,</span> <span class="s2">&quot;HS ACC%&quot;</span><span class="p">]]</span>
    <span class="n">acc</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;ACC%&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">acc</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">acc</span></div>


<div class="viewcode-block" id="kast"><a class="viewcode-back" href="../../../analytics.html#awpy.analytics.stats.kast">[docs]</a><span class="k">def</span> <span class="nf">kast</span><span class="p">(</span>
    <span class="n">kill_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">kast_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;KAST&quot;</span><span class="p">,</span>
    <span class="n">flash_assists</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">kill_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">death_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns a dataframe with KAST statistics.</span>

<span class="sd">    Args:</span>
<span class="sd">        kill_data: A dataframe with kill data.</span>
<span class="sd">        kast_string: A string specifying which combination of KAST statistics</span>
<span class="sd">            to use.</span>
<span class="sd">        flash_assists: A boolean specifying if flash assists are to be</span>
<span class="sd">            counted as assists or not.</span>
<span class="sd">        kill_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by kill_data to filter the kill data by and</span>
<span class="sd">            the values are lists that contain the column filters.</span>
<span class="sd">        death_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by kill_data to filter the death data by and</span>
<span class="sd">            the values are lists that contain the column filters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dataframe containing the percentage of a player&#39;s rounds with at least one of (K)ill, (A)ssist, (S)urvival and (T)rades.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Player&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">kast_string</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">]</span>
    <span class="n">kast_counts</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">kast_rounds</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">stat</span> <span class="ow">in</span> <span class="n">kast_string</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
        <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stat</span><span class="p">)</span>
    <span class="n">kill_data</span> <span class="o">=</span> <span class="n">kill_data</span><span class="p">[</span><span class="o">~</span><span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;attackerName&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
    <span class="n">killers</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">kill_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;attackerTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;victimTeam&quot;</span><span class="p">]],</span>
        <span class="n">kill_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">&quot;roundNum&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;attackerName&quot;</span><span class="p">],</span>
        <span class="p">[[</span><span class="s2">&quot;sum&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">&quot;RoundNum&quot;</span><span class="p">,</span> <span class="s2">&quot;Killers&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">victims</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">kill_data</span><span class="p">,</span>
        <span class="n">kill_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">&quot;roundNum&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;victimName&quot;</span><span class="p">],</span>
        <span class="p">[[</span><span class="s2">&quot;sum&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">&quot;RoundNum&quot;</span><span class="p">,</span> <span class="s2">&quot;Victims&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">assisters</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">kill_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;assisterTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;victimTeam&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
        <span class="n">kill_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">&quot;roundNum&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;assisterName&quot;</span><span class="p">],</span>
        <span class="p">[[</span><span class="s2">&quot;sum&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">&quot;RoundNum&quot;</span><span class="p">,</span> <span class="s2">&quot;Assisters&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">traded</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">kill_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="p">(</span><span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;attackerTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;victimTeam&quot;</span><span class="p">])</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;isTrade&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span>
        <span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
        <span class="n">kill_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">&quot;roundNum&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;playerTradedName&quot;</span><span class="p">],</span>
        <span class="p">[[</span><span class="s2">&quot;sum&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">&quot;RoundNum&quot;</span><span class="p">,</span> <span class="s2">&quot;Traded&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">flash_assists</span><span class="p">:</span>
        <span class="n">flash_assisters</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
            <span class="n">kill_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                <span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;flashThrowerTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;victimTeam&quot;</span><span class="p">]</span>
            <span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="n">kill_filters</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;roundNum&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;flashThrowerName&quot;</span><span class="p">],</span>
            <span class="p">[[</span><span class="s2">&quot;sum&quot;</span><span class="p">]],</span>
            <span class="p">[</span><span class="s2">&quot;RoundNum&quot;</span><span class="p">,</span> <span class="s2">&quot;Flash Assisters&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">assisters</span> <span class="o">=</span> <span class="n">assisters</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">flash_assisters</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;RoundNum&quot;</span><span class="p">)</span>
        <span class="n">assisters</span><span class="p">[</span><span class="s2">&quot;Assisters&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">assisters</span><span class="p">[</span><span class="s2">&quot;Assisters&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">assisters</span><span class="p">[</span><span class="s2">&quot;Flash Assisters&quot;</span><span class="p">]</span>
        <span class="n">assisters</span> <span class="o">=</span> <span class="n">assisters</span><span class="p">[[</span><span class="s2">&quot;RoundNum&quot;</span><span class="p">,</span> <span class="s2">&quot;Assisters&quot;</span><span class="p">]]</span>
    <span class="n">kast_data</span> <span class="o">=</span> <span class="n">killers</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">assisters</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">kast_data</span> <span class="o">=</span> <span class="n">kast_data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">victims</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">kast_data</span> <span class="o">=</span> <span class="n">kast_data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">traded</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">killer_names</span> <span class="o">=</span> <span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;attackerName&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">cleaned_killer_names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">killer_names</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cleaned_killer_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">cleaned_killer_names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">cleaned_killer_names</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">cleaned_killer_names</span><span class="p">:</span>
        <span class="n">kast_counts</span><span class="p">[</span><span class="n">player</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kast_data</span><span class="p">))]</span>
        <span class="n">kast_rounds</span><span class="p">[</span><span class="n">player</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">rd</span> <span class="ow">in</span> <span class="n">kast_data</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">kast_counts</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;K&quot;</span> <span class="ow">in</span> <span class="n">kast_string</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
                <span class="n">kast_counts</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="n">rd</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">kast_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">rd</span><span class="p">][</span><span class="s2">&quot;Killers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
                <span class="n">kast_rounds</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">kast_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">rd</span><span class="p">][</span><span class="s2">&quot;Killers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;A&quot;</span> <span class="ow">in</span> <span class="n">kast_string</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
                <span class="n">kast_counts</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="n">rd</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">kast_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">rd</span><span class="p">][</span><span class="s2">&quot;Assisters&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                    <span class="n">player</span>
                <span class="p">)</span>
                <span class="n">kast_rounds</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">kast_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">rd</span><span class="p">][</span><span class="s2">&quot;Assisters&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;S&quot;</span> <span class="ow">in</span> <span class="n">kast_string</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">player</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kast_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">rd</span><span class="p">][</span><span class="s2">&quot;Victims&quot;</span><span class="p">]:</span>
                    <span class="n">kast_counts</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="n">rd</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">kast_rounds</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="s2">&quot;T&quot;</span> <span class="ow">in</span> <span class="n">kast_string</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
                <span class="n">kast_counts</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="n">rd</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">kast_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">rd</span><span class="p">][</span><span class="s2">&quot;Traded&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
                <span class="n">kast_rounds</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">+=</span> <span class="n">kast_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">rd</span><span class="p">][</span><span class="s2">&quot;Traded&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">kast_rounds</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">rd</span> <span class="ow">in</span> <span class="n">kast_counts</span><span class="p">[</span><span class="n">player</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">rd</span><span class="p">):</span>
                <span class="n">kast_rounds</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">kast_rounds</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">kast_data</span><span class="p">)</span>
    <span class="n">kast</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">kast_rounds</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">kast</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Player&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">kast_string</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span> <span class="s2">&quot;K&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">]</span>
    <span class="n">kast</span> <span class="o">=</span> <span class="n">kast</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span>
    <span class="n">kast</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">kast</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">kast_string</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">kast</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kast</span></div>


<div class="viewcode-block" id="kill_stats"><a class="viewcode-back" href="../../../analytics.html#awpy.analytics.stats.kill_stats">[docs]</a><span class="k">def</span> <span class="nf">kill_stats</span><span class="p">(</span>
    <span class="n">damage_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">kill_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">round_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">weapon_fire_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">team</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">damage_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">kill_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">death_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">round_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">weapon_fire_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns a dataframe with kill statistics.</span>

<span class="sd">    Args:</span>
<span class="sd">        damage_data: A dataframe with damage data.</span>
<span class="sd">        kill_data: A dataframe with kill data.</span>
<span class="sd">        round_data: A dataframe with round data.</span>
<span class="sd">        weapon_fire_data: A dataframe with weapon fire data.</span>
<span class="sd">            where each round is a dictionary.</span>
<span class="sd">        team: A boolean specifying whether to calculate statistics for each team</span>
<span class="sd">            or for each player. The default is to calculate statistics for</span>
<span class="sd">            each player.</span>
<span class="sd">        damage_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by damage_data to filter the damage data by</span>
<span class="sd">            and the values are lists that contain the column filters.</span>
<span class="sd">        kill_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by kill_data to filter the kill data by and</span>
<span class="sd">            the values are lists that contain the column filters.</span>
<span class="sd">        death_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by kill_data to filter the death data by and</span>
<span class="sd">            the values are lists that contain the column filters.</span>
<span class="sd">        round_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by round_data to filter the round data by and</span>
<span class="sd">            the values are lists that contain the column filters.</span>
<span class="sd">        weapon_fire_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by weapon_fires to filter the weapon fire data</span>
<span class="sd">            by and the values are lists that contain the column filters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dataframe with kills, deaths, assists, flash assists, first kills/deaths, headshots, headshot kills/total kills, KAST and accuracy statistics.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;attackerName&quot;</span><span class="p">,</span> <span class="s2">&quot;victimName&quot;</span><span class="p">,</span> <span class="s2">&quot;assisterName&quot;</span><span class="p">,</span> <span class="s2">&quot;flashThrowerName&quot;</span><span class="p">,</span> <span class="s2">&quot;Player&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">team</span><span class="p">:</span>
        <span class="n">stats</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;attackerTeam&quot;</span><span class="p">,</span>
            <span class="s2">&quot;victimTeam&quot;</span><span class="p">,</span>
            <span class="s2">&quot;assisterTeam&quot;</span><span class="p">,</span>
            <span class="s2">&quot;flashThrowerTeam&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Team&quot;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="n">kills</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">kill_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;attackerTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;victimTeam&quot;</span><span class="p">]],</span>
        <span class="n">kill_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;K&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">deaths</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">kill_data</span><span class="p">,</span>
        <span class="n">death_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;D&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">assists</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">kill_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;assisterTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;victimTeam&quot;</span><span class="p">]],</span>
        <span class="n">kill_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;A&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">flash_assists</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">kill_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;flashThrowerTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;victimTeam&quot;</span><span class="p">]],</span>
        <span class="n">kill_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;FA&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">first_kills</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">kill_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="p">(</span><span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;attackerTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;victimTeam&quot;</span><span class="p">])</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;isFirstKill&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span>
        <span class="p">],</span>
        <span class="n">kill_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;FK&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">first_deaths</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">kill_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="p">(</span><span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;attackerTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;victimTeam&quot;</span><span class="p">])</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;isFirstKill&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span>
        <span class="p">],</span>
        <span class="n">kill_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;FD&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">headshots</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">kill_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="p">(</span><span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;attackerTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;victimTeam&quot;</span><span class="p">])</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;isHeadshot&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span>
        <span class="p">],</span>
        <span class="n">kill_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;HS&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">headshot_pct</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">kill_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;attackerTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;victimTeam&quot;</span><span class="p">]],</span>
        <span class="n">kill_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">&quot;isHeadshot&quot;</span><span class="p">],</span>
        <span class="p">[[</span><span class="s2">&quot;mean&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;HS%&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">team</span><span class="p">:</span>
        <span class="n">acc_stats</span> <span class="o">=</span> <span class="n">accuracy</span><span class="p">(</span>
            <span class="n">damage_data</span><span class="p">,</span> <span class="n">weapon_fire_data</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">damage_filters</span><span class="p">,</span> <span class="n">weapon_fire_filters</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">acc_stats</span> <span class="o">=</span> <span class="n">accuracy</span><span class="p">(</span>
            <span class="n">damage_data</span><span class="p">,</span> <span class="n">weapon_fire_data</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">damage_filters</span><span class="p">,</span> <span class="n">weapon_fire_filters</span>
        <span class="p">)</span>
    <span class="n">kast_stats</span> <span class="o">=</span> <span class="n">kast</span><span class="p">(</span><span class="n">kill_data</span><span class="p">,</span> <span class="s2">&quot;KAST&quot;</span><span class="p">,</span> <span class="n">kill_filters</span><span class="p">,</span> <span class="n">death_filters</span><span class="p">)</span>
    <span class="n">kill_stats</span> <span class="o">=</span> <span class="n">kills</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">deaths</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">kill_stats</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">assists</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">kill_stats</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">flash_assists</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">kill_stats</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">first_kills</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">kill_stats</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">first_deaths</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">kill_stats</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">headshots</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">kill_stats</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">headshot_pct</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">kill_stats</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">acc_stats</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">team</span><span class="p">:</span>
        <span class="n">kill_stats</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">kast_stats</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;+/-&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;D&quot;</span><span class="p">]</span>
    <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;KDR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;D&quot;</span><span class="p">]</span>
    <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;KPR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span>
        <span class="n">calc_stats</span><span class="p">(</span><span class="n">round_data</span><span class="p">,</span> <span class="n">round_filters</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="n">round_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;FK +/-&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;FK&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;FD&quot;</span><span class="p">]</span>
    <span class="n">int_stats</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;FA&quot;</span><span class="p">,</span> <span class="s2">&quot;+/-&quot;</span><span class="p">,</span> <span class="s2">&quot;FK&quot;</span><span class="p">,</span> <span class="s2">&quot;FK +/-&quot;</span><span class="p">,</span> <span class="s2">&quot;HS&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">team</span><span class="p">:</span>
        <span class="n">int_stats</span> <span class="o">=</span> <span class="n">int_stats</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">kill_stats</span><span class="p">[</span><span class="n">int_stats</span><span class="p">]</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="p">[</span><span class="n">int_stats</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;HS%&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;HS%&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">order</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">stats</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
        <span class="s2">&quot;K&quot;</span><span class="p">,</span>
        <span class="s2">&quot;D&quot;</span><span class="p">,</span>
        <span class="s2">&quot;A&quot;</span><span class="p">,</span>
        <span class="s2">&quot;FA&quot;</span><span class="p">,</span>
        <span class="s2">&quot;+/-&quot;</span><span class="p">,</span>
        <span class="s2">&quot;FK&quot;</span><span class="p">,</span>
        <span class="s2">&quot;FK +/-&quot;</span><span class="p">,</span>
        <span class="s2">&quot;T&quot;</span><span class="p">,</span>
        <span class="s2">&quot;HS&quot;</span><span class="p">,</span>
        <span class="s2">&quot;HS%&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ACC%&quot;</span><span class="p">,</span>
        <span class="s2">&quot;HS ACC%&quot;</span><span class="p">,</span>
        <span class="s2">&quot;KDR&quot;</span><span class="p">,</span>
        <span class="s2">&quot;KPR&quot;</span><span class="p">,</span>
        <span class="s2">&quot;KAST%&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="n">team</span><span class="p">:</span>
        <span class="n">order</span> <span class="o">=</span> <span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="n">order</span><span class="p">[</span><span class="mi">9</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">kill_stats</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="p">[</span><span class="n">order</span><span class="p">]</span>
    <span class="n">kill_stats</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;K&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">kill_stats</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kill_stats</span></div>


<div class="viewcode-block" id="adr"><a class="viewcode-back" href="../../../analytics.html#awpy.analytics.stats.adr">[docs]</a><span class="k">def</span> <span class="nf">adr</span><span class="p">(</span>
    <span class="n">damage_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">round_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">team</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">damage_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">round_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns a dataframe with ADR statistics.</span>

<span class="sd">    Args:</span>
<span class="sd">        damage_data: A dataframe with damage data.</span>
<span class="sd">        round_data: A dataframe with round data.</span>
<span class="sd">        team: A boolean specifying whether to calculate statistics for each team</span>
<span class="sd">            or for each player. The default is to calculate statistics for</span>
<span class="sd">            each player.</span>
<span class="sd">        damage_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by damage_data to filter the damage data by</span>
<span class="sd">            and the values are lists that contain the column filters.</span>
<span class="sd">        round_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by round_data to filter the round data by and</span>
<span class="sd">            the values are lists that contain the column filters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dataframe with the average damage per round (ADR).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;attackerName&quot;</span><span class="p">,</span> <span class="s2">&quot;Player&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">team</span><span class="p">:</span>
        <span class="n">stats</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;attackerTeam&quot;</span><span class="p">,</span> <span class="s2">&quot;Team&quot;</span><span class="p">]</span>
    <span class="n">adr</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">damage_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">damage_data</span><span class="p">[</span><span class="s2">&quot;attackerTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">damage_data</span><span class="p">[</span><span class="s2">&quot;victimTeam&quot;</span><span class="p">]],</span>
        <span class="n">damage_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">&quot;hpDamageTaken&quot;</span><span class="p">,</span> <span class="s2">&quot;hpDamage&quot;</span><span class="p">],</span>
        <span class="p">[[</span><span class="s2">&quot;sum&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;sum&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;Norm ADR&quot;</span><span class="p">,</span> <span class="s2">&quot;Raw ADR&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">adr</span><span class="p">[</span><span class="s2">&quot;Norm ADR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adr</span><span class="p">[</span><span class="s2">&quot;Norm ADR&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span>
        <span class="n">calc_stats</span><span class="p">(</span><span class="n">round_data</span><span class="p">,</span> <span class="n">round_filters</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="n">round_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">adr</span><span class="p">[</span><span class="s2">&quot;Raw ADR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adr</span><span class="p">[</span><span class="s2">&quot;Raw ADR&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span>
        <span class="n">calc_stats</span><span class="p">(</span><span class="n">round_data</span><span class="p">,</span> <span class="n">round_filters</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="n">round_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">adr</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Norm ADR&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">adr</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">adr</span></div>


<div class="viewcode-block" id="rating"><a class="viewcode-back" href="../../../analytics.html#awpy.analytics.stats.rating">[docs]</a><span class="k">def</span> <span class="nf">rating</span><span class="p">(</span>
    <span class="n">damage_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">kill_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">round_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">damage_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">death_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">kill_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">round_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns a dataframe with an HLTV-esque rating, found by doing:</span>

<span class="sd">    Rating = 0.0073*KAST + 0.3591*KPR + -0.5329*DPR + 0.2372*Impact + 0.0032*ADR + 0.1587</span>
<span class="sd">    where Impact = 2.13*KPR + 0.42*Assist per Round -0.41</span>

<span class="sd">    Args:</span>
<span class="sd">        damage_data: A dataframe with damage data.</span>
<span class="sd">        kill_data: A dataframe with damage data.</span>
<span class="sd">        round_data: A dataframe with round data.</span>
<span class="sd">        damage_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by damage_data to filter the damage data by</span>
<span class="sd">            and the values are lists that contain the column filters.</span>
<span class="sd">        death_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by kill_data to filter the death data by and</span>
<span class="sd">            the values are lists that contain the column filters.</span>
<span class="sd">        kill_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by kill_data to filter the kill data by and</span>
<span class="sd">            the values are lists that contain the column filters.</span>
<span class="sd">        round_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by round_data to filter the round data by and</span>
<span class="sd">            the values are lists that contain the column filters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dataframe with the impact rating and rating 2.0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kast_stats</span> <span class="o">=</span> <span class="n">kast</span><span class="p">(</span><span class="n">kill_data</span><span class="p">,</span> <span class="s2">&quot;KAST&quot;</span><span class="p">,</span> <span class="n">kill_filters</span><span class="p">,</span> <span class="n">death_filters</span><span class="p">)</span>
    <span class="n">kast_stats</span> <span class="o">=</span> <span class="n">kast_stats</span><span class="p">[[</span><span class="s2">&quot;Player&quot;</span><span class="p">,</span> <span class="s2">&quot;KAST%&quot;</span><span class="p">]]</span>
    <span class="n">kast_stats</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Player&quot;</span><span class="p">,</span> <span class="s2">&quot;KAST&quot;</span><span class="p">]</span>
    <span class="n">adr_stats</span> <span class="o">=</span> <span class="n">adr</span><span class="p">(</span><span class="n">damage_data</span><span class="p">,</span> <span class="n">round_data</span><span class="p">,</span> <span class="n">damage_filters</span><span class="p">,</span> <span class="n">round_filters</span><span class="p">)</span>
    <span class="n">adr_stats</span> <span class="o">=</span> <span class="n">adr_stats</span><span class="p">[[</span><span class="s2">&quot;Player&quot;</span><span class="p">,</span> <span class="s2">&quot;Norm ADR&quot;</span><span class="p">]]</span>
    <span class="n">adr_stats</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Player&quot;</span><span class="p">,</span> <span class="s2">&quot;ADR&quot;</span><span class="p">]</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;attackerName&quot;</span><span class="p">,</span> <span class="s2">&quot;victimName&quot;</span><span class="p">,</span> <span class="s2">&quot;assisterName&quot;</span><span class="p">,</span> <span class="s2">&quot;flashThrowerName&quot;</span><span class="p">,</span> <span class="s2">&quot;Player&quot;</span><span class="p">]</span>
    <span class="n">kills</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">kill_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;attackerTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;victimTeam&quot;</span><span class="p">]],</span>
        <span class="n">kill_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;K&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">deaths</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">kill_data</span><span class="p">,</span>
        <span class="n">death_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;D&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">assists</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">kill_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;assisterTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;victimTeam&quot;</span><span class="p">]],</span>
        <span class="n">kill_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;A&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">kill_stats</span> <span class="o">=</span> <span class="n">kills</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">deaths</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">kill_stats</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">assists</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;KPR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span>
        <span class="n">calc_stats</span><span class="p">(</span><span class="n">round_data</span><span class="p">,</span> <span class="n">round_filters</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="n">round_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;DPR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;D&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span>
        <span class="n">calc_stats</span><span class="p">(</span><span class="n">round_data</span><span class="p">,</span> <span class="n">round_filters</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="n">round_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;APR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span>
        <span class="n">calc_stats</span><span class="p">(</span><span class="n">round_data</span><span class="p">,</span> <span class="n">round_filters</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="n">round_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">kill_stats</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="p">[[</span><span class="s2">&quot;Player&quot;</span><span class="p">,</span> <span class="s2">&quot;KPR&quot;</span><span class="p">,</span> <span class="s2">&quot;DPR&quot;</span><span class="p">,</span> <span class="s2">&quot;APR&quot;</span><span class="p">]]</span>
    <span class="n">kill_stats</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">adr_stats</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">kill_stats</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">kast_stats</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;Impact&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.13</span> <span class="o">*</span> <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;KPR&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.42</span> <span class="o">*</span> <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;APR&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.41</span>
    <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;Rating&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mf">0.73</span> <span class="o">*</span> <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;KAST&quot;</span><span class="p">]</span>
        <span class="o">+</span> <span class="mf">0.3591</span> <span class="o">*</span> <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;KPR&quot;</span><span class="p">]</span>
        <span class="o">-</span> <span class="mf">0.5329</span> <span class="o">*</span> <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;DPR&quot;</span><span class="p">]</span>
        <span class="o">+</span> <span class="mf">0.2372</span> <span class="o">*</span> <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;Impact&quot;</span><span class="p">]</span>
        <span class="o">+</span> <span class="mf">0.0032</span> <span class="o">*</span> <span class="n">kill_stats</span><span class="p">[</span><span class="s2">&quot;ADR&quot;</span><span class="p">]</span>
        <span class="o">+</span> <span class="mf">0.1587</span>
    <span class="p">)</span>
    <span class="n">kill_stats</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="p">[[</span><span class="s2">&quot;Player&quot;</span><span class="p">,</span> <span class="s2">&quot;Impact&quot;</span><span class="p">,</span> <span class="s2">&quot;Rating&quot;</span><span class="p">]]</span>
    <span class="n">kill_stats</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Rating&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">kill_stats</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kill_stats</span></div>


<div class="viewcode-block" id="util_dmg"><a class="viewcode-back" href="../../../analytics.html#awpy.analytics.stats.util_dmg">[docs]</a><span class="k">def</span> <span class="nf">util_dmg</span><span class="p">(</span>
    <span class="n">damage_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">grenade_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">team</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">damage_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">grenade_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns a dataframe with utility damage statistics.</span>

<span class="sd">    Args:</span>
<span class="sd">        damage_data: A dataframe with damage data.</span>
<span class="sd">        grenade_data: A dataframe with grenade data.</span>
<span class="sd">        team: A boolean specifying whether to calculate statistics for each team</span>
<span class="sd">            or for each player. The default is to calculate statistics for</span>
<span class="sd">            each player.</span>
<span class="sd">        damage_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by damage_data to filter the damage data by</span>
<span class="sd">            and the values are lists that contain the column filters.</span>
<span class="sd">        grenade_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by grenade_data to filter the grenade data by</span>
<span class="sd">            and the values are lists that contain the column filters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dataframe with nades thrown, given utility damage (UD) per nade</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;attackerName&quot;</span><span class="p">,</span> <span class="s2">&quot;throwerName&quot;</span><span class="p">,</span> <span class="s2">&quot;Player&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">team</span><span class="p">:</span>
        <span class="n">stats</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;attackerTeam&quot;</span><span class="p">,</span> <span class="s2">&quot;throwerTeam&quot;</span><span class="p">,</span> <span class="s2">&quot;Team&quot;</span><span class="p">]</span>
    <span class="n">util_dmg</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">damage_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="p">(</span><span class="n">damage_data</span><span class="p">[</span><span class="s2">&quot;attackerTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">damage_data</span><span class="p">[</span><span class="s2">&quot;victimTeam&quot;</span><span class="p">])</span>
            <span class="o">&amp;</span> <span class="p">(</span>
                <span class="n">damage_data</span><span class="p">[</span><span class="s2">&quot;weapon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span>
                    <span class="p">[</span><span class="s2">&quot;HE Grenade&quot;</span><span class="p">,</span> <span class="s2">&quot;Incendiary Grenade&quot;</span><span class="p">,</span> <span class="s2">&quot;Molotov&quot;</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="p">],</span>
        <span class="n">damage_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">&quot;hpDamageTaken&quot;</span><span class="p">,</span> <span class="s2">&quot;hpDamage&quot;</span><span class="p">],</span>
        <span class="p">[[</span><span class="s2">&quot;sum&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;sum&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;Given UD&quot;</span><span class="p">,</span> <span class="s2">&quot;UD&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">nades_thrown</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">grenade_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="n">grenade_data</span><span class="p">[</span><span class="s2">&quot;grenadeType&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span>
                <span class="p">[</span><span class="s2">&quot;HE Grenade&quot;</span><span class="p">,</span> <span class="s2">&quot;Incendiary Grenade&quot;</span><span class="p">,</span> <span class="s2">&quot;Molotov&quot;</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">],</span>
        <span class="n">grenade_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;Nades Thrown&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">util_dmg_stats</span> <span class="o">=</span> <span class="n">util_dmg</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">nades_thrown</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">util_dmg_stats</span><span class="p">[</span><span class="s2">&quot;Given UD Per Nade&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">util_dmg_stats</span><span class="p">[</span><span class="s2">&quot;Given UD&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">util_dmg_stats</span><span class="p">[</span><span class="s2">&quot;Nades Thrown&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">util_dmg_stats</span><span class="p">[</span><span class="s2">&quot;UD Per Nade&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">util_dmg_stats</span><span class="p">[</span><span class="s2">&quot;UD&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">util_dmg_stats</span><span class="p">[</span><span class="s2">&quot;Nades Thrown&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">util_dmg_stats</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Given UD&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">util_dmg_stats</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">util_dmg_stats</span></div>


<div class="viewcode-block" id="flash_stats"><a class="viewcode-back" href="../../../analytics.html#awpy.analytics.stats.flash_stats">[docs]</a><span class="k">def</span> <span class="nf">flash_stats</span><span class="p">(</span>
    <span class="n">flash_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">grenade_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">kill_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">team</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">flash_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">grenade_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">kill_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns a dataframe with flashbang statistics.</span>

<span class="sd">    Args:</span>
<span class="sd">        flash_data: A dataframe with flash data.</span>
<span class="sd">        grenade_data: A dataframe with grenade data.</span>
<span class="sd">        kill_data: A dataframe with kill data.</span>
<span class="sd">        team: A boolean specifying whether to calculate statistics for each team</span>
<span class="sd">            or for each player. The default is to calculate statistics for</span>
<span class="sd">            each player.</span>
<span class="sd">        flash_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by flash_data to filter the flash data by</span>
<span class="sd">            and the values are lists that contain the column filters.</span>
<span class="sd">        grenade_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by grenade_data to filter the grenade data by</span>
<span class="sd">            and the values are lists that contain the column filters.</span>
<span class="sd">        kill_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by kill_data to filter the kill data by and</span>
<span class="sd">            the values are lists that contain the column filters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dataframe with the effective flashes (EF), flash assists (FA), effective blind time (EBT), team flashes (TF), total flashes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;attackerName&quot;</span><span class="p">,</span> <span class="s2">&quot;flashThrowerName&quot;</span><span class="p">,</span> <span class="s2">&quot;throwerName&quot;</span><span class="p">,</span> <span class="s2">&quot;Player&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">team</span><span class="p">:</span>
        <span class="n">stats</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;attackerTeam&quot;</span><span class="p">,</span> <span class="s2">&quot;flashThrowerTeam&quot;</span><span class="p">,</span> <span class="s2">&quot;throwerTeam&quot;</span><span class="p">,</span> <span class="s2">&quot;Team&quot;</span><span class="p">]</span>
    <span class="n">enemy_flashes</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">flash_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">flash_data</span><span class="p">[</span><span class="s2">&quot;attackerTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">flash_data</span><span class="p">[</span><span class="s2">&quot;playerTeam&quot;</span><span class="p">]],</span>
        <span class="n">flash_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;EF&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">flash_assists</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">kill_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;flashThrowerTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;victimTeam&quot;</span><span class="p">]],</span>
        <span class="n">kill_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;FA&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">blind_time</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">flash_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">flash_data</span><span class="p">[</span><span class="s2">&quot;attackerTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">flash_data</span><span class="p">[</span><span class="s2">&quot;playerTeam&quot;</span><span class="p">]],</span>
        <span class="n">flash_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">&quot;flashDuration&quot;</span><span class="p">],</span>
        <span class="p">[[</span><span class="s2">&quot;sum&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;EBT&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">team_flashes</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">flash_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">flash_data</span><span class="p">[</span><span class="s2">&quot;attackerTeam&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">flash_data</span><span class="p">[</span><span class="s2">&quot;playerTeam&quot;</span><span class="p">]],</span>
        <span class="n">flash_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;TF&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">flashes_thrown</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">grenade_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">grenade_data</span><span class="p">[</span><span class="s2">&quot;grenadeType&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Flashbang&quot;</span><span class="p">],</span>
        <span class="n">flash_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;Flashes Thrown&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">flash_stats</span> <span class="o">=</span> <span class="n">enemy_flashes</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">flash_assists</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">flash_stats</span> <span class="o">=</span> <span class="n">flash_stats</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">blind_time</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">flash_stats</span> <span class="o">=</span> <span class="n">flash_stats</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">team_flashes</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">flash_stats</span> <span class="o">=</span> <span class="n">flash_stats</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">flashes_thrown</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">flash_stats</span><span class="p">[</span><span class="s2">&quot;EF Per Throw&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flash_stats</span><span class="p">[</span><span class="s2">&quot;EF&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">flash_stats</span><span class="p">[</span><span class="s2">&quot;Flashes Thrown&quot;</span><span class="p">]</span>
    <span class="n">flash_stats</span><span class="p">[</span><span class="s2">&quot;EBT Per Enemy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flash_stats</span><span class="p">[</span><span class="s2">&quot;EBT&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">flash_stats</span><span class="p">[</span><span class="s2">&quot;EF&quot;</span><span class="p">]</span>
    <span class="n">flash_stats</span><span class="p">[</span><span class="s2">&quot;FA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flash_stats</span><span class="p">[</span><span class="s2">&quot;FA&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">flash_stats</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;EF&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">flash_stats</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">flash_stats</span></div>


<div class="viewcode-block" id="bomb_stats"><a class="viewcode-back" href="../../../analytics.html#awpy.analytics.stats.bomb_stats">[docs]</a><span class="k">def</span> <span class="nf">bomb_stats</span><span class="p">(</span>
    <span class="n">bomb_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">bomb_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns a dataframe with bomb event statistics.</span>

<span class="sd">    Args:</span>
<span class="sd">        bomb_data: A dataframe with bomb event data.</span>
<span class="sd">        bomb_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by bomb_data to filter the bomb data by and</span>
<span class="sd">            the values are lists that contain the column filters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dataframe with bomb plant summaries.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">team_one</span> <span class="o">=</span> <span class="n">bomb_data</span><span class="p">[</span><span class="s2">&quot;playerTeam&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">team_two</span> <span class="o">=</span> <span class="n">bomb_data</span><span class="p">[</span><span class="s2">&quot;playerTeam&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">team_one_plants</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">bomb_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="p">(</span><span class="n">bomb_data</span><span class="p">[</span><span class="s2">&quot;bombAction&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;plant&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">bomb_data</span><span class="p">[</span><span class="s2">&quot;playerTeam&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">team_one</span><span class="p">)</span>
        <span class="p">],</span>
        <span class="n">bomb_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">&quot;bombSite&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;bombSite&quot;</span><span class="p">],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">&quot;Bombsite&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">team_one</span><span class="si">}</span><span class="s2"> Plants&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">team_two_plants</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">bomb_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="p">(</span><span class="n">bomb_data</span><span class="p">[</span><span class="s2">&quot;bombAction&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;plant&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">bomb_data</span><span class="p">[</span><span class="s2">&quot;playerTeam&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">team_two</span><span class="p">)</span>
        <span class="p">],</span>
        <span class="n">bomb_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">&quot;bombSite&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;bombSite&quot;</span><span class="p">],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">&quot;Bombsite&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">team_two</span><span class="si">}</span><span class="s2"> Plants&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">team_one_defuses</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">bomb_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="p">(</span><span class="n">bomb_data</span><span class="p">[</span><span class="s2">&quot;bombAction&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;defuse&quot;</span><span class="p">)</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">bomb_data</span><span class="p">[</span><span class="s2">&quot;playerTeam&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">team_one</span><span class="p">)</span>
        <span class="p">],</span>
        <span class="n">bomb_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">&quot;bombSite&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;bombSite&quot;</span><span class="p">],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">&quot;Bombsite&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">team_one</span><span class="si">}</span><span class="s2"> Defuses&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">team_two_defuses</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">bomb_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="p">(</span><span class="n">bomb_data</span><span class="p">[</span><span class="s2">&quot;bombAction&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;defuse&quot;</span><span class="p">)</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">bomb_data</span><span class="p">[</span><span class="s2">&quot;playerTeam&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">team_two</span><span class="p">)</span>
        <span class="p">],</span>
        <span class="n">bomb_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">&quot;bombSite&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;bombSite&quot;</span><span class="p">],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">&quot;Bombsite&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">team_two</span><span class="si">}</span><span class="s2"> Defuses&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">bomb_stats</span> <span class="o">=</span> <span class="n">team_one_plants</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">team_two_defuses</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">bomb_stats</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">team_two</span><span class="si">}</span><span class="s2"> Defuse %&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">bomb_stats</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">team_two</span><span class="si">}</span><span class="s2"> Defuses&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">bomb_stats</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">team_one</span><span class="si">}</span><span class="s2"> Plants&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">bomb_stats</span> <span class="o">=</span> <span class="n">bomb_stats</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">team_two_plants</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">bomb_stats</span> <span class="o">=</span> <span class="n">bomb_stats</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">team_one_defuses</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">bomb_stats</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">team_one</span><span class="si">}</span><span class="s2"> Defuse %&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">bomb_stats</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">team_one</span><span class="si">}</span><span class="s2"> Defuses&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">bomb_stats</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">team_two</span><span class="si">}</span><span class="s2"> Plants&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">bomb_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;A and B&quot;</span><span class="p">,</span>
        <span class="n">bomb_stats</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">team_one</span><span class="si">}</span><span class="s2"> Plants&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
        <span class="n">bomb_stats</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">team_two</span><span class="si">}</span><span class="s2"> Defuses&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
        <span class="p">(</span>
            <span class="n">bomb_stats</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">team_two</span><span class="si">}</span><span class="s2"> Defuses&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
            <span class="o">/</span> <span class="n">bomb_stats</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">team_one</span><span class="si">}</span><span class="s2"> Plants&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="p">),</span>
        <span class="n">bomb_stats</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">team_two</span><span class="si">}</span><span class="s2"> Plants&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
        <span class="n">bomb_stats</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">team_one</span><span class="si">}</span><span class="s2"> Defuses&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
        <span class="p">(</span>
            <span class="n">bomb_stats</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">team_one</span><span class="si">}</span><span class="s2"> Defuses&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
            <span class="o">/</span> <span class="n">bomb_stats</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">team_two</span><span class="si">}</span><span class="s2"> Plants&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="p">),</span>
    <span class="p">]</span>
    <span class="n">bomb_stats</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">bomb_stats</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span> <span class="o">=</span> <span class="n">bomb_stats</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bomb_stats</span></div>


<div class="viewcode-block" id="econ_stats"><a class="viewcode-back" href="../../../analytics.html#awpy.analytics.stats.econ_stats">[docs]</a><span class="k">def</span> <span class="nf">econ_stats</span><span class="p">(</span>
    <span class="n">round_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">round_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns a dataframe with economy statistics.</span>

<span class="sd">    Args:</span>
<span class="sd">        round_data: A dataframe with round data.</span>
<span class="sd">        round_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by round_data to filter the round data by and</span>
<span class="sd">            the values are lists that contain the column filters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dataframe with round economy summaries.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ct_stats</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">round_data</span><span class="p">,</span>
        <span class="n">round_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">&quot;ctTeam&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;ctStartEqVal&quot;</span><span class="p">,</span> <span class="s2">&quot;ctRoundStartMoney&quot;</span><span class="p">,</span> <span class="s2">&quot;ctSpend&quot;</span><span class="p">],</span>
        <span class="p">[[</span><span class="s2">&quot;mean&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">&quot;Side&quot;</span><span class="p">,</span> <span class="s2">&quot;Avg EQ Value&quot;</span><span class="p">,</span> <span class="s2">&quot;Avg Cash&quot;</span><span class="p">,</span> <span class="s2">&quot;Avg Spend&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">ct_stats</span><span class="p">[</span><span class="s2">&quot;Side&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ct_stats</span><span class="p">[</span><span class="s2">&quot;Side&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; CT&quot;</span>
    <span class="n">ct_buys</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">round_data</span><span class="p">,</span>
        <span class="n">round_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">&quot;ctTeam&quot;</span><span class="p">,</span> <span class="s2">&quot;ctBuyType&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;ctBuyType&quot;</span><span class="p">],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">&quot;Side&quot;</span><span class="p">,</span> <span class="s2">&quot;Buy Type&quot;</span><span class="p">,</span> <span class="s2">&quot;Counts&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">ct_buys</span> <span class="o">=</span> <span class="n">ct_buys</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;Side&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Buy Type&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;Counts&quot;</span><span class="p">)</span>
    <span class="n">ct_buys</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ct_buys</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ct_buys</span><span class="p">[</span><span class="s2">&quot;Side&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ct_buys</span><span class="p">[</span><span class="s2">&quot;Side&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; CT&quot;</span>
    <span class="n">t_stats</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">round_data</span><span class="p">,</span>
        <span class="n">round_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">&quot;tTeam&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;tStartEqVal&quot;</span><span class="p">,</span> <span class="s2">&quot;tRoundStartMoney&quot;</span><span class="p">,</span> <span class="s2">&quot;tSpend&quot;</span><span class="p">],</span>
        <span class="p">[[</span><span class="s2">&quot;mean&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">&quot;Side&quot;</span><span class="p">,</span> <span class="s2">&quot;Avg EQ Value&quot;</span><span class="p">,</span> <span class="s2">&quot;Avg Cash&quot;</span><span class="p">,</span> <span class="s2">&quot;Avg Spend&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">t_stats</span><span class="p">[</span><span class="s2">&quot;Side&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t_stats</span><span class="p">[</span><span class="s2">&quot;Side&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; T&quot;</span>
    <span class="n">t_buys</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">round_data</span><span class="p">,</span>
        <span class="n">round_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">&quot;tTeam&quot;</span><span class="p">,</span> <span class="s2">&quot;tBuyType&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;tBuyType&quot;</span><span class="p">],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">&quot;Side&quot;</span><span class="p">,</span> <span class="s2">&quot;Buy Type&quot;</span><span class="p">,</span> <span class="s2">&quot;Counts&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">t_buys</span> <span class="o">=</span> <span class="n">t_buys</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;Side&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Buy Type&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;Counts&quot;</span><span class="p">)</span>
    <span class="n">t_buys</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">t_buys</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">t_buys</span><span class="p">[</span><span class="s2">&quot;Side&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t_buys</span><span class="p">[</span><span class="s2">&quot;Side&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; T&quot;</span>
    <span class="n">econ_buys</span> <span class="o">=</span> <span class="n">ct_buys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t_buys</span><span class="p">)</span>
    <span class="n">econ_stats</span> <span class="o">=</span> <span class="n">ct_stats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t_stats</span><span class="p">)</span>
    <span class="n">econ_stats</span> <span class="o">=</span> <span class="n">econ_buys</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">econ_stats</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
    <span class="n">econ_stats</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">econ_stats</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">econ_stats</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">econ_stats</span></div>


<div class="viewcode-block" id="weapon_type"><a class="viewcode-back" href="../../../analytics.html#awpy.analytics.stats.weapon_type">[docs]</a><span class="k">def</span> <span class="nf">weapon_type</span><span class="p">(</span><span class="n">weapon</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns the weapon type of a weapon.</span>

<span class="sd">    Args:</span>
<span class="sd">        weapon: Weapon name</span>

<span class="sd">    Returns:</span>
<span class="sd">        A string for the weapon type (Knife, Pistol, Shotgun, SMG, Assault Rifle, Machine Gun, Sniper Rifle, Utility)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">weapon</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Knife&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="s2">&quot;Melee Kills&quot;</span>
    <span class="k">elif</span> <span class="n">weapon</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s2">&quot;CZ-75 Auto&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Desert Eagle&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Dual Berettas&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Five-SeveN&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Glock-18&quot;</span><span class="p">,</span>
        <span class="s2">&quot;P2000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;P250&quot;</span><span class="p">,</span>
        <span class="s2">&quot;R8 Revolver&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Tec-9&quot;</span><span class="p">,</span>
        <span class="s2">&quot;USP-S&quot;</span><span class="p">,</span>
    <span class="p">]:</span>
        <span class="k">return</span> <span class="s2">&quot;Pistol Kills&quot;</span>
    <span class="k">elif</span> <span class="n">weapon</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;MAG-7&quot;</span><span class="p">,</span> <span class="s2">&quot;Nova&quot;</span><span class="p">,</span> <span class="s2">&quot;Sawed-Off&quot;</span><span class="p">,</span> <span class="s2">&quot;XM1014&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="s2">&quot;Shotgun Kills&quot;</span>
    <span class="k">elif</span> <span class="n">weapon</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;MAC-10&quot;</span><span class="p">,</span> <span class="s2">&quot;MP5-SD&quot;</span><span class="p">,</span> <span class="s2">&quot;MP7&quot;</span><span class="p">,</span> <span class="s2">&quot;MP9&quot;</span><span class="p">,</span> <span class="s2">&quot;P90&quot;</span><span class="p">,</span> <span class="s2">&quot;PP-Bizon&quot;</span><span class="p">,</span> <span class="s2">&quot;UMP-45&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="s2">&quot;SMG Kills&quot;</span>
    <span class="k">elif</span> <span class="n">weapon</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;AK-47&quot;</span><span class="p">,</span> <span class="s2">&quot;AUG&quot;</span><span class="p">,</span> <span class="s2">&quot;FAMAS&quot;</span><span class="p">,</span> <span class="s2">&quot;Galil AR&quot;</span><span class="p">,</span> <span class="s2">&quot;M4A1-S&quot;</span><span class="p">,</span> <span class="s2">&quot;M4A4&quot;</span><span class="p">,</span> <span class="s2">&quot;SG 553&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="s2">&quot;Assault Rifle Kills&quot;</span>
    <span class="k">elif</span> <span class="n">weapon</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;M249&quot;</span><span class="p">,</span> <span class="s2">&quot;Negev&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="s2">&quot;Machine Gun Kills&quot;</span>
    <span class="k">elif</span> <span class="n">weapon</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;AWP&quot;</span><span class="p">,</span> <span class="s2">&quot;G3SG1&quot;</span><span class="p">,</span> <span class="s2">&quot;SCAR-20&quot;</span><span class="p">,</span> <span class="s2">&quot;SSG 08&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="s2">&quot;Sniper Rifle Kills&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Utility Kills&quot;</span></div>


<div class="viewcode-block" id="kill_breakdown"><a class="viewcode-back" href="../../../analytics.html#awpy.analytics.stats.kill_breakdown">[docs]</a><span class="k">def</span> <span class="nf">kill_breakdown</span><span class="p">(</span>
    <span class="n">kill_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">team</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">kill_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns a dataframe with kills broken down by weapon type.</span>

<span class="sd">    Args:</span>
<span class="sd">        kill_data: A dataframe with kill data.</span>
<span class="sd">        team: A boolean specifying whether to calculate statistics for each team</span>
<span class="sd">            or for each player. The default is to calculate statistics for</span>
<span class="sd">            each player.</span>
<span class="sd">        kill_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by kill_data to filter the kill data by and</span>
<span class="sd">            the values are lists that contain the column filters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dataframe with kill type statistics.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;attackerName&quot;</span><span class="p">,</span> <span class="s2">&quot;Player&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">team</span><span class="p">:</span>
        <span class="n">stats</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;attackerTeam&quot;</span><span class="p">,</span> <span class="s2">&quot;Team&quot;</span><span class="p">]</span>
    <span class="n">kill_breakdown</span> <span class="o">=</span> <span class="n">kill_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
        <span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;attackerTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">kill_data</span><span class="p">[</span><span class="s2">&quot;victimTeam&quot;</span><span class="p">]</span>
    <span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">kill_breakdown</span><span class="p">[</span><span class="s2">&quot;Kills Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kill_breakdown</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">weapon_type</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;weapon&quot;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">)</span>
    <span class="n">kill_breakdown</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">kill_breakdown</span><span class="p">,</span>
        <span class="n">kill_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;Kills Type&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;Kills Type&quot;</span><span class="p">,</span> <span class="s2">&quot;Kills&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">kill_breakdown</span> <span class="o">=</span> <span class="n">kill_breakdown</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span>
        <span class="n">index</span><span class="o">=</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Kills Type&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;Kills&quot;</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s2">&quot;Melee Kills&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Pistol Kills&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Shotgun Kills&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SMG Kills&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Assault Rifle Kills&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Machine Gun Kills&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Sniper Rifle Kills&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Utility Kills&quot;</span><span class="p">,</span>
    <span class="p">]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">kill_breakdown</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">kill_breakdown</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">kill_breakdown</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">kill_breakdown</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">kill_breakdown</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">kill_breakdown</span><span class="p">[</span><span class="s2">&quot;Total Kills&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kill_breakdown</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">kill_breakdown</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">kill_breakdown</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">kill_breakdown</span> <span class="o">=</span> <span class="n">kill_breakdown</span><span class="p">[</span>
        <span class="p">[</span>
            <span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;Melee Kills&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Pistol Kills&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Shotgun Kills&quot;</span><span class="p">,</span>
            <span class="s2">&quot;SMG Kills&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Assault Rifle Kills&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Machine Gun Kills&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Sniper Rifle Kills&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Utility Kills&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Total Kills&quot;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">]</span>
    <span class="n">kill_breakdown</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Total Kills&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">kill_breakdown</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kill_breakdown</span></div>


<div class="viewcode-block" id="util_dmg_breakdown"><a class="viewcode-back" href="../../../analytics.html#awpy.analytics.stats.util_dmg_breakdown">[docs]</a><span class="k">def</span> <span class="nf">util_dmg_breakdown</span><span class="p">(</span>
    <span class="n">damage_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">grenade_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">team</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">damage_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">grenade_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns a dataframe with utility damage statistics broken down by grenade type.</span>

<span class="sd">    Args:</span>
<span class="sd">        damage_data: A dataframe with damage data.</span>
<span class="sd">        grenade_data: A dataframe with grenade data.</span>
<span class="sd">        team: A boolean specifying whether to calculate statistics for each team</span>
<span class="sd">            or for each player. The default is to calculate statistics for</span>
<span class="sd">            each player.</span>
<span class="sd">        damage_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by damage_data to filter the damage data by</span>
<span class="sd">            and the values are lists that contain the column filters.</span>
<span class="sd">        grenade_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by grenade_data to filter the grenade data by</span>
<span class="sd">            and the values are lists that contain the column filters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dataframe with utility damage summary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;attackerName&quot;</span><span class="p">,</span> <span class="s2">&quot;throwerName&quot;</span><span class="p">,</span> <span class="s2">&quot;Player&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">team</span><span class="p">:</span>
        <span class="n">stats</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;attackerTeam&quot;</span><span class="p">,</span> <span class="s2">&quot;throwerTeam&quot;</span><span class="p">,</span> <span class="s2">&quot;Team&quot;</span><span class="p">]</span>
    <span class="n">util_dmg</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">damage_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="p">(</span><span class="n">damage_data</span><span class="p">[</span><span class="s2">&quot;attackerTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">damage_data</span><span class="p">[</span><span class="s2">&quot;victimTeam&quot;</span><span class="p">])</span>
            <span class="o">&amp;</span> <span class="p">(</span>
                <span class="n">damage_data</span><span class="p">[</span><span class="s2">&quot;weapon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span>
                    <span class="p">[</span><span class="s2">&quot;HE Grenade&quot;</span><span class="p">,</span> <span class="s2">&quot;Incendiary Grenade&quot;</span><span class="p">,</span> <span class="s2">&quot;Molotov&quot;</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="p">],</span>
        <span class="n">damage_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;weapon&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;hpDamageTaken&quot;</span><span class="p">,</span> <span class="s2">&quot;hpDamage&quot;</span><span class="p">],</span>
        <span class="p">[[</span><span class="s2">&quot;sum&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;sum&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;Nade Type&quot;</span><span class="p">,</span> <span class="s2">&quot;Given UD&quot;</span><span class="p">,</span> <span class="s2">&quot;UD&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">nades_thrown</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">grenade_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="n">grenade_data</span><span class="p">[</span><span class="s2">&quot;grenadeType&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span>
                <span class="p">[</span><span class="s2">&quot;HE Grenade&quot;</span><span class="p">,</span> <span class="s2">&quot;Incendiary Grenade&quot;</span><span class="p">,</span> <span class="s2">&quot;Molotov&quot;</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">],</span>
        <span class="n">grenade_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;grenadeType&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;Nade Type&quot;</span><span class="p">,</span> <span class="s2">&quot;Nades Thrown&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">util_dmg_breakdown</span> <span class="o">=</span> <span class="n">util_dmg</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">nades_thrown</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;Nade Type&quot;</span><span class="p">]</span>
    <span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">util_dmg_breakdown</span><span class="p">[</span><span class="s2">&quot;Given UD Per Nade&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">util_dmg_breakdown</span><span class="p">[</span><span class="s2">&quot;Given UD&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">util_dmg_breakdown</span><span class="p">[</span><span class="s2">&quot;Nades Thrown&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">util_dmg_breakdown</span><span class="p">[</span><span class="s2">&quot;UD Per Nade&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">util_dmg_breakdown</span><span class="p">[</span><span class="s2">&quot;UD&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">util_dmg_breakdown</span><span class="p">[</span><span class="s2">&quot;Nades Thrown&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">util_dmg_breakdown</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
        <span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;Given UD&quot;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">util_dmg_breakdown</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">util_dmg_breakdown</span></div>


<div class="viewcode-block" id="win_breakdown"><a class="viewcode-back" href="../../../analytics.html#awpy.analytics.stats.win_breakdown">[docs]</a><span class="k">def</span> <span class="nf">win_breakdown</span><span class="p">(</span>
    <span class="n">round_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">round_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns a dataframe with wins broken down by round end reason.</span>

<span class="sd">    Args:</span>
<span class="sd">        round_data: A dataframe with round data.</span>
<span class="sd">        round_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">            dataframe represented by round_data to filter the round data by and</span>
<span class="sd">            the values are lists that contain the column filters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dataframe with round wins described by reason.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">round_data_copy</span> <span class="o">=</span> <span class="n">round_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">round_data_copy</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;BombDefused&quot;</span><span class="p">,</span> <span class="s2">&quot;CT Bomb Defusal Wins&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">round_data_copy</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;CTWin&quot;</span><span class="p">,</span> <span class="s2">&quot;CT T Elim Wins&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">round_data_copy</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;TargetBombed&quot;</span><span class="p">,</span> <span class="s2">&quot;T Bomb Detonation Wins&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">round_data_copy</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;TargetSaved&quot;</span><span class="p">,</span> <span class="s2">&quot;CT Time Expired Wins&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">round_data_copy</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;TerroristsWin&quot;</span><span class="p">,</span> <span class="s2">&quot;T CT Elim Wins&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">win_breakdown</span> <span class="o">=</span> <span class="n">calc_stats</span><span class="p">(</span>
        <span class="n">round_data_copy</span><span class="p">,</span>
        <span class="n">round_filters</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">&quot;winningTeam&quot;</span><span class="p">,</span> <span class="s2">&quot;roundEndReason&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;roundEndReason&quot;</span><span class="p">],</span>
        <span class="p">[[</span><span class="s2">&quot;size&quot;</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">&quot;Team&quot;</span><span class="p">,</span> <span class="s2">&quot;RoundEndReason&quot;</span><span class="p">,</span> <span class="s2">&quot;Count&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">win_breakdown</span> <span class="o">=</span> <span class="n">win_breakdown</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span>
        <span class="n">index</span><span class="o">=</span><span class="s2">&quot;Team&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;RoundEndReason&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;Count&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">win_breakdown</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">win_breakdown</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">win_breakdown</span><span class="p">[</span><span class="s2">&quot;Total CT Wins&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">win_breakdown</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:][</span>
        <span class="nb">list</span><span class="p">(</span>
            <span class="nb">set</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span>
                <span class="nb">set</span><span class="p">(</span><span class="n">win_breakdown</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span>
                <span class="nb">set</span><span class="p">([</span><span class="s2">&quot;CT Bomb Defusal Wins&quot;</span><span class="p">,</span> <span class="s2">&quot;CT T Elim Wins&quot;</span><span class="p">,</span> <span class="s2">&quot;CT Time Expired Wins&quot;</span><span class="p">]),</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">win_breakdown</span><span class="p">[</span><span class="s2">&quot;Total T Wins&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">win_breakdown</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:][</span>
        <span class="nb">list</span><span class="p">(</span>
            <span class="nb">set</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span>
                <span class="nb">set</span><span class="p">(</span><span class="n">win_breakdown</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span>
                <span class="nb">set</span><span class="p">([</span><span class="s2">&quot;T Bomb Detonation Wins&quot;</span><span class="p">,</span> <span class="s2">&quot;T CT Elim Wins&quot;</span><span class="p">]),</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">win_breakdown</span><span class="p">[</span><span class="s2">&quot;Total Wins&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">win_breakdown</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:,</span> <span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">win_breakdown</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">win_breakdown</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">win_breakdown</span></div>


<div class="viewcode-block" id="player_box_score"><a class="viewcode-back" href="../../../analytics.html#awpy.analytics.stats.player_box_score">[docs]</a><span class="k">def</span> <span class="nf">player_box_score</span><span class="p">(</span>
    <span class="n">damage_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">flash_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">grenade_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">kill_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">round_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">weapon_fire_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">damage_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">flash_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">grenade_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">kill_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">death_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">round_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">weapon_fire_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns a player box score dataframe.</span>

<span class="sd">    Args:</span>
<span class="sd">       damage_data: A dataframe with damage data.</span>
<span class="sd">       flash_data: A dataframe with flash data.</span>
<span class="sd">       grenade_data: A dataframe with grenade data.</span>
<span class="sd">       kill_data: A dataframe with kill data.</span>
<span class="sd">       round_data: A dataframe with round data.</span>
<span class="sd">       weapon_fire_data: A dataframe with weapon fire data.</span>
<span class="sd">       damage_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">           dataframe represented by damage_data to filter the damage data by</span>
<span class="sd">           and the values are lists that contain the column filters.</span>
<span class="sd">       flash_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">           dataframe represented by flash_data to filter the flash data by</span>
<span class="sd">           and the values are lists that contain the column filters.</span>
<span class="sd">       grenade_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">           dataframe represented by grenade_data to filter the grenade data by</span>
<span class="sd">           and the values are lists that contain the column filters.</span>
<span class="sd">       kill_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">           dataframe represented by kill_data to filter the kill data by and</span>
<span class="sd">           the values are lists that contain the column filters.</span>
<span class="sd">       death_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">           dataframe represented by kill_data to filter the death data by and</span>
<span class="sd">           the values are lists that contain the column filters.</span>
<span class="sd">       round_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">           dataframe represented by round_data to filter the round data by and</span>
<span class="sd">           the values are lists that contain the column filters.</span>
<span class="sd">       weapon_fire_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">           dataframe to filter the weapon fire data by and the values are lists</span>
<span class="sd">           that contain the column filters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dataframe with player summaries.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">k_stats</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="p">(</span>
        <span class="n">damage_data</span><span class="p">,</span>
        <span class="n">kill_data</span><span class="p">,</span>
        <span class="n">round_data</span><span class="p">,</span>
        <span class="n">weapon_fire_data</span><span class="p">,</span>
        <span class="n">damage_filters</span><span class="p">,</span>
        <span class="n">kill_filters</span><span class="p">,</span>
        <span class="n">death_filters</span><span class="p">,</span>
        <span class="n">round_filters</span><span class="p">,</span>
        <span class="n">weapon_fire_filters</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">k_stats</span> <span class="o">=</span> <span class="n">k_stats</span><span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;Player&quot;</span><span class="p">,</span> <span class="s2">&quot;K&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;FA&quot;</span><span class="p">,</span> <span class="s2">&quot;HS%&quot;</span><span class="p">,</span> <span class="s2">&quot;ACC%&quot;</span><span class="p">,</span> <span class="s2">&quot;HS ACC%&quot;</span><span class="p">,</span> <span class="s2">&quot;KDR&quot;</span><span class="p">,</span> <span class="s2">&quot;KAST%&quot;</span><span class="p">]</span>
    <span class="p">]</span>
    <span class="n">adr_stats</span> <span class="o">=</span> <span class="n">adr</span><span class="p">(</span><span class="n">damage_data</span><span class="p">,</span> <span class="n">round_data</span><span class="p">,</span> <span class="n">damage_filters</span><span class="p">,</span> <span class="n">round_filters</span><span class="p">)</span>
    <span class="n">adr_stats</span> <span class="o">=</span> <span class="n">adr_stats</span><span class="p">[[</span><span class="s2">&quot;Player&quot;</span><span class="p">,</span> <span class="s2">&quot;Norm ADR&quot;</span><span class="p">]]</span>
    <span class="n">adr_stats</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Player&quot;</span><span class="p">,</span> <span class="s2">&quot;ADR&quot;</span><span class="p">]</span>
    <span class="n">ud_stats</span> <span class="o">=</span> <span class="n">util_dmg</span><span class="p">(</span><span class="n">damage_data</span><span class="p">,</span> <span class="n">grenade_data</span><span class="p">,</span> <span class="n">damage_filters</span><span class="p">,</span> <span class="n">grenade_filters</span><span class="p">)</span>
    <span class="n">ud_stats</span> <span class="o">=</span> <span class="n">ud_stats</span><span class="p">[[</span><span class="s2">&quot;Player&quot;</span><span class="p">,</span> <span class="s2">&quot;UD&quot;</span><span class="p">,</span> <span class="s2">&quot;UD Per Nade&quot;</span><span class="p">]]</span>
    <span class="n">f_stats</span> <span class="o">=</span> <span class="n">flash_stats</span><span class="p">(</span>
        <span class="n">flash_data</span><span class="p">,</span>
        <span class="n">grenade_data</span><span class="p">,</span>
        <span class="n">kill_data</span><span class="p">,</span>
        <span class="n">flash_filters</span><span class="p">,</span>
        <span class="n">grenade_filters</span><span class="p">,</span>
        <span class="n">kill_filters</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">f_stats</span> <span class="o">=</span> <span class="n">f_stats</span><span class="p">[[</span><span class="s2">&quot;Player&quot;</span><span class="p">,</span> <span class="s2">&quot;EF&quot;</span><span class="p">,</span> <span class="s2">&quot;EF Per Throw&quot;</span><span class="p">]]</span>
    <span class="n">rating_stats</span> <span class="o">=</span> <span class="n">rating</span><span class="p">(</span>
        <span class="n">damage_data</span><span class="p">,</span>
        <span class="n">kill_data</span><span class="p">,</span>
        <span class="n">round_data</span><span class="p">,</span>
        <span class="n">damage_filters</span><span class="p">,</span>
        <span class="n">death_filters</span><span class="p">,</span>
        <span class="n">kill_filters</span><span class="p">,</span>
        <span class="n">round_filters</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">box_score</span> <span class="o">=</span> <span class="n">k_stats</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">adr_stats</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">box_score</span> <span class="o">=</span> <span class="n">box_score</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ud_stats</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">box_score</span> <span class="o">=</span> <span class="n">box_score</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">f_stats</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">box_score</span> <span class="o">=</span> <span class="n">box_score</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">rating_stats</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">box_score</span></div>


<div class="viewcode-block" id="team_box_score"><a class="viewcode-back" href="../../../analytics.html#awpy.analytics.stats.team_box_score">[docs]</a><span class="k">def</span> <span class="nf">team_box_score</span><span class="p">(</span>
    <span class="n">damage_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">flash_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">grenade_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">kill_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">round_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">weapon_fire_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">damage_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">flash_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">grenade_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">kill_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">death_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">round_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">weapon_fire_filters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{},</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns a team box score dataframe.</span>

<span class="sd">    Args:</span>
<span class="sd">       damage_data: A dataframe with damage data.</span>
<span class="sd">       flash_data: A dataframe with flash data.</span>
<span class="sd">       grenade_data: A dataframe with grenade data.</span>
<span class="sd">       kill_data: A dataframe with kill data.</span>
<span class="sd">       round_data: A dataframe with round data.</span>
<span class="sd">       weapon_fire_data: A dataframe with weapon fire data.</span>
<span class="sd">       damage_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">           dataframe represented by damage_data to filter the damage data by</span>
<span class="sd">           and the values are lists that contain the column filters.</span>
<span class="sd">       flash_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">           dataframe represented by flash_data to filter the flash data by</span>
<span class="sd">           and the values are lists that contain the column filters.</span>
<span class="sd">       grenade_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">           dataframe represented by grenade_data to filter the grenade data by</span>
<span class="sd">           and the values are lists that contain the column filters.</span>
<span class="sd">       kill_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">           dataframe represented by kill_data to filter the kill data by and</span>
<span class="sd">           the values are lists that contain the column filters.</span>
<span class="sd">       death_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">           dataframe represented by kill_data to filter the death data by and</span>
<span class="sd">           the values are lists that contain the column filters.</span>
<span class="sd">       round_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">           dataframe represented by round_data to filter the round data by and</span>
<span class="sd">           the values are lists that contain the column filters.</span>
<span class="sd">       weapon_fire_filters: A dictionary where the keys are the columns of the</span>
<span class="sd">           dataframe to filter the weapon fire data by and the values are lists</span>
<span class="sd">           that contain the column filters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dataframe with team summaries.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">k_stats</span> <span class="o">=</span> <span class="n">kill_stats</span><span class="p">(</span>
        <span class="n">damage_data</span><span class="p">,</span>
        <span class="n">kill_data</span><span class="p">,</span>
        <span class="n">round_data</span><span class="p">,</span>
        <span class="n">weapon_fire_data</span><span class="p">,</span>
        <span class="kc">True</span><span class="p">,</span>
        <span class="n">damage_filters</span><span class="p">,</span>
        <span class="n">kill_filters</span><span class="p">,</span>
        <span class="n">death_filters</span><span class="p">,</span>
        <span class="n">round_filters</span><span class="p">,</span>
        <span class="n">weapon_fire_filters</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">acc_stats</span> <span class="o">=</span> <span class="n">accuracy</span><span class="p">(</span>
        <span class="n">damage_data</span><span class="p">,</span> <span class="n">weapon_fire_data</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">damage_filters</span><span class="p">,</span> <span class="n">weapon_fire_filters</span>
    <span class="p">)</span>
    <span class="n">adr_stats</span> <span class="o">=</span> <span class="n">adr</span><span class="p">(</span><span class="n">damage_data</span><span class="p">,</span> <span class="n">round_data</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">damage_filters</span><span class="p">,</span> <span class="n">round_filters</span><span class="p">)</span>
    <span class="n">ud_stats</span> <span class="o">=</span> <span class="n">util_dmg</span><span class="p">(</span>
        <span class="n">damage_data</span><span class="p">,</span> <span class="n">grenade_data</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">damage_filters</span><span class="p">,</span> <span class="n">grenade_filters</span>
    <span class="p">)</span>
    <span class="n">f_stats</span> <span class="o">=</span> <span class="n">flash_stats</span><span class="p">(</span>
        <span class="n">flash_data</span><span class="p">,</span>
        <span class="n">grenade_data</span><span class="p">,</span>
        <span class="n">kill_data</span><span class="p">,</span>
        <span class="kc">True</span><span class="p">,</span>
        <span class="n">flash_filters</span><span class="p">,</span>
        <span class="n">grenade_filters</span><span class="p">,</span>
        <span class="n">kill_filters</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">e_stats</span> <span class="o">=</span> <span class="n">econ_stats</span><span class="p">(</span><span class="n">round_data</span><span class="p">,</span> <span class="n">round_filters</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">e_stats</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">e_stats</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">e_stats</span><span class="p">[</span><span class="s2">&quot;Side&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="n">index</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">rounds</span> <span class="o">=</span> <span class="n">e_stats</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">e_stats</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">=</span> <span class="n">e_stats</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">*</span> <span class="n">rounds</span>
    <span class="n">e_stats</span> <span class="o">=</span> <span class="n">e_stats</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Side&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">e_stats</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">e_stats</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">e_stats</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">filter_df</span><span class="p">(</span><span class="n">round_data</span><span class="p">,</span> <span class="n">round_filters</span><span class="p">))</span>
    <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">e_stats</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Side&quot;</span><span class="p">:</span> <span class="s2">&quot;Team&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">box_score</span> <span class="o">=</span> <span class="n">k_stats</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">acc_stats</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
    <span class="n">box_score</span> <span class="o">=</span> <span class="n">box_score</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">adr_stats</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
    <span class="n">box_score</span> <span class="o">=</span> <span class="n">box_score</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ud_stats</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
    <span class="n">box_score</span> <span class="o">=</span> <span class="n">box_score</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">f_stats</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
    <span class="n">box_score</span> <span class="o">=</span> <span class="n">box_score</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">e_stats</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
    <span class="n">box_score</span> <span class="o">=</span> <span class="n">box_score</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">win_breakdown</span><span class="p">(</span><span class="n">round_data</span><span class="p">,</span> <span class="n">round_filters</span><span class="p">),</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">box_score</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;Norm ADR&quot;</span><span class="p">:</span> <span class="s2">&quot;ADR&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Total CT Wins&quot;</span><span class="p">:</span> <span class="s2">&quot;CT Wins&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Total T Wins&quot;</span><span class="p">:</span> <span class="s2">&quot;T Wins&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Total Wins&quot;</span><span class="p">:</span> <span class="s2">&quot;Score&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">box_score</span><span class="p">[</span><span class="s2">&quot;Score&quot;</span><span class="p">]</span>
    <span class="n">ct_wins</span> <span class="o">=</span> <span class="n">box_score</span><span class="p">[</span><span class="s2">&quot;CT Wins&quot;</span><span class="p">]</span>
    <span class="n">t_wins</span> <span class="o">=</span> <span class="n">box_score</span><span class="p">[</span><span class="s2">&quot;T Wins&quot;</span><span class="p">]</span>
    <span class="n">box_score</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;Score&quot;</span><span class="p">,</span> <span class="s2">&quot;CT Wins&quot;</span><span class="p">,</span> <span class="s2">&quot;T Wins&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">box_score</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Score&quot;</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span>
    <span class="n">box_score</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;CT Wins&quot;</span><span class="p">,</span> <span class="n">ct_wins</span><span class="p">)</span>
    <span class="n">box_score</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;T Wins&quot;</span><span class="p">,</span> <span class="n">t_wins</span><span class="p">)</span>
    <span class="n">box_score</span> <span class="o">=</span> <span class="n">box_score</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">box_score</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">box_score</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">box_score</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Team&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">box_score</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">box_score</span> <span class="o">=</span> <span class="n">box_score</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
        <span class="p">[</span>
            <span class="s2">&quot;Score&quot;</span><span class="p">,</span>
            <span class="s2">&quot;CT Wins&quot;</span><span class="p">,</span>
            <span class="s2">&quot;T Wins&quot;</span><span class="p">,</span>
            <span class="s2">&quot;K&quot;</span><span class="p">,</span>
            <span class="s2">&quot;D&quot;</span><span class="p">,</span>
            <span class="s2">&quot;A&quot;</span><span class="p">,</span>
            <span class="s2">&quot;FA&quot;</span><span class="p">,</span>
            <span class="s2">&quot;+/-&quot;</span><span class="p">,</span>
            <span class="s2">&quot;FK&quot;</span><span class="p">,</span>
            <span class="s2">&quot;HS&quot;</span><span class="p">,</span>
            <span class="s2">&quot;HS%&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Strafe%&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ACC%&quot;</span><span class="p">,</span>
            <span class="s2">&quot;HS ACC%&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ADR&quot;</span><span class="p">,</span>
            <span class="s2">&quot;UD&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Nades Thrown&quot;</span><span class="p">,</span>
            <span class="s2">&quot;UD Per Nade&quot;</span><span class="p">,</span>
            <span class="s2">&quot;EF&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Flashes Thrown&quot;</span><span class="p">,</span>
            <span class="s2">&quot;EF Per Throw&quot;</span><span class="p">,</span>
            <span class="s2">&quot;EBT Per Enemy&quot;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="p">:,</span>
    <span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">box_score</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">31</span><span class="p">:,</span> <span class="p">:])</span>
    <span class="k">return</span> <span class="n">box_score</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Peter Xenopoulos.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>